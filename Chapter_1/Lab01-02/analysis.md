### Lab1-2
 
Analyze the file Lab01-02.exe.

Questions:<br/>
**1]** Upload the Lab01-02.exe file to http://www.VirusTotal.com/. Does it match any existing antivirus definitions?
Solution: 
At the time of writing this solution,  

*	43/68 AVs detected the Lab01-02.exe as malicious Trojan. Many AVs classified this executable as a Downloader.

**2]** Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible.
Solution: 
Yes. This executable is obfuscated.
Signs of obfuscation:

*	Analyzing strings present in Lab01-02.exe: There are many strings present. But all the wierd and unclear. Consider this string **om#Int6net Explo!r 8FEI**. I can mostly conclude that the actual string is **Internet Explorer 8**. There are many such wierd strings.
* There are strings like **UPX0**, **UPX1**, **UPX2**, **UPX!**. UPX is a very popular packer. This is a very strong sign that the executable is packed using UPX tool.
* When viewed the executable using PEView, instead of section names being .text, .data, .rdata etc., , the section names were UPX0, UPX1, UPX2.
* PEiD v0.95 said nothing about the executable. It said "Nothing found".

Conclusion: Mostly, the UPX tool has been used to pack this, which can also be used to unpack it.

**3]** Do any imports hint at this programâ€™s functionality? If so, which imports are they and what do they tell you?
Solution: After unpacking using the UPX tool, this analysis has been done.

* There are imports from **ADVAPI32.dll** :
	* **CreateService** , **OpenSCManager**, **StartServiceCtrlDispatcher** are functions related to creating a service(a process which runs in background) and managing that service. So, a service is never naturally seen to a normal user unless he/she goes to the task manager and keenly observes it.

* There are imports from **WININET.dll** :

*	The **InternetOpen**, **InternetOpenURL** functions are used to communicate to URLs. The InternetpOpenURL function specially supports **ftp**, **http**, **https**. Accessing a URL brings some suspicion, but the ftp and http protocols bring even more suspicion about this malware being a downloader because these are the protocols generally used to transfer files.

**4]** What host- or network-based indicators could be used to identify this malware on infected machines?
Solution: 
Analyzing strings of the unpacked image gave a few details. Found many strings but a few important ones are

* **Malservice**
* **MalService**
* **http://malwareanalysisbook.com**
* **Internet Explorer 8.0**

Guess is that we can search for a service named "Malservice" or "MalService". This can be a host-based indicator.

A strong network indicator is the URL http://malwareanalysisbook.com. So, anytime an application makes a DNS lookup for this URL, it can be caught.

**Detailed Analysis** :

**Lab01-02.exe**

**NOTE**: All this has been done after unpacking the executable.

1. Output of VirusTotal.com :
	
	* 47/66 AVs detected the image to be malicious. A few of them classified it as a Downloader.
	
2. Imports from **ADVAPI32.dll** :
	
	* **CreateService**
	* **OpenSCManager**
	* **StartServiceCTRLDispatcher**

3. Imports from **WININET.dll** :
	
	* **InternetOpen**
	* **InternetOpenURL**
4. Imports from **KERNEL32.dll** :
	
	* **OpenMutex**
	* **CreateMutex**
	* **SystemTimeToFileTime**
	* **CreateThread**
	* **WaitForSingleObject**
5. Strings present in the image which felt relevant for analysis:
	* **Malservice**
	* **MalService**
	* **HGL345**
	* **http://malwareanalysisbook.com**
	* **Internet Explorer 8.0**

**Connecting the dots and Hypothesis** 

1. The functions imported from **WININET.dll** . It imports InternetOpen, InternetOpenURL which are functions used to communicate with an URL. From the strings, it is evident that http://malwareanalysisbook.com will be accessed.
3. Functions imported from **ADVAPI32.dll** : These functions evidently show that a service will be created and runs in the background without the layman user noticing it. From the strings it can be guessed that a service named Malservice or MalService will be started. 

So, the inclination towards it being a Downloader is more than it being a Backdoor because,

* Many AV engines of VirusTotal classified it as a Downloader .
* It is accessing a website. Generally in backdoors, something known as a reverse shell is created where the victim machine itself gets connected to a given IP Address. But here, there is a URL given. Thought every URL gets translated to an IP Address, there might be multiple IP Addresses for 1 given URL. This is alright from the malware point of view if it is a Downloader. But this is a problem if it a backdoor because there might exist only 1 machine(1 IP Address) which is listening to connections from the victim machine. 

**PS**: All the functions imported by the image, are explained properly in the MSDN (MIcrosoft Developers' Network) Library. There is also a summary written in this repo which gives a clear idea of what the function does.
